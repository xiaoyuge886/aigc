## 项目文档

> **业务背景**：我们是一家 ToB 智能化解决方案提供商，服务于企业级客户（金融、制造、政务、医疗等行业）。当前核心痛点是交付成本高、定制化需求多、知识资产难以沉淀。

---

### 一、背景与目标（Why - 业务价值与市场机会）

- **1.1 当前 ToB 业务痛点与挑战**
  - **交付成本居高不下**：每个客户项目需要从零开发定制化 workflow，团队陷入"项目制"泥潭，难以规模化复用。单个项目交付成本 30-50 万，交付周期 2-3 个月，人效低下。
  - **客户期望升级**：企业客户对 AI 的认知从"流程自动化"升级到"智能自主决策"，不再满足于固定规则的工作流编排，期待具备理解、规划、执行能力的 Agent 形态。客户明确表示"不想再用 workflow，需要 Agent 能力"。
  - **行业场景差异巨大**：不同行业、不同客户的业务场景千差万别，传统方案难以通用：
    - **水利规划局**：关注水利工程设计、档案数据问答、通用水工建筑物详细报告
    - **宁夏交建（交通建设）**：关注工程标书制作、施工方案优化、招投标文档生成
    - **标书写作场景**：关注技术方案撰写、商务报价生成、资质文件整理、合规性检查、多格式文档输出
    - **金融行业**：关注合规审查、风险评估报告、监管报表生成
    - **制造业**：关注生产数据分析、质量报告、设备维护方案
  - **维护与演进成本**：传统 workflow 方案每次客户需求变更都需要开发介入，后期维护成本随客户数量线性增长。客户数量越多，维护成本越高，难以规模化。
  - **企业级需求复杂**：
    - **安全合规**：企业客户要求数据隔离、权限控制、审计日志、合规性保障（如等保、ISO27001）
    - **多租户隔离**：不同企业/部门需要完全隔离的数据和配置空间
    - **SLA 保障**：企业客户需要明确的服务等级协议（可用性 ≥99.5%、响应时间 <2 秒）
    - **私有化部署**：部分客户（如政府、金融）要求私有化部署，数据不出域

- **1.2 市场机会与竞争优势**
  - **Agent 化转型窗口期**：市场上 ToB Agent 产品尚处早期，企业客户对 Agent 能力需求强烈，但市场缺乏成熟的企业级 Agent 平台。率先推出企业级 Agent 平台可抢占先机，建立行业标准。
  - **知识资产沉淀**：将行业经验沉淀为"场景 + Prompt + Skill"资产，构建竞争壁垒。场景库和 Skill 库越丰富，平台价值越高，形成正向循环。
  - **降本增效显著**：通过平台化复用，将单个项目交付周期从 2-3 个月缩短到 4-6 周，交付成本从 30-50 万降至 5-10 万，人效提升 3-4 倍。
  - **商业模式创新**：
    - **SaaS 订阅制**：按租户/用户数/调用量收费，持续收入模式
    - **私有化部署 License**：一次性授权 + 年度维护费，满足高安全要求客户
    - **场景库交易**：行业场景库可作为独立产品线，按场景授权收费
    - **生态分成**：Skill 市场、场景市场支持第三方开发者，平台抽成

- **1.3 本项目要解决什么问题**
  - **统一 AI 能力入口**：为企业内部团队和客户提供一站式 AI 控制台，降低 AI 使用门槛。
  - **能力资产化**：用"业务场景 + Prompt + Skill"把行业经验沉淀为可配置、可复用、可交易的资产。
  - **系统自我进化**：基于用户反馈和偏好，实现系统的持续优化，降低人工调优成本。
  - **多租户隔离**：支持不同企业/部门的场景隔离与个性化配置。

- **1.4 项目愿景与商业价值**
  - **短期愿景**：打造"AI 操作系统"——配置什么 **Prompt + 场景 + Skill**，就能自动执行对应的业务任务。
  - **长期愿景**：构建 ToB AI 应用生态平台：
    - 对内：提效 50%+，交付成本降低 70%+
    - 对外：向客户提供 SaaS 化 Agent 平台，支持私有化部署与定制化服务
    - 生态：沉淀行业场景库，形成可交易的 AI 能力市场

  - **配图**：[📊 整体架构图](./diagrams/architecture_overview.html)

---

### 二、产品功能全景（What - 企业级能力矩阵）

- **2.1 产品定位与核心价值**
  - **定位**：企业级 AI 智能控制台与应用运行平台，为 ToB 客户提供统一、安全、可控的 AI 能力入口与场景化解决方案。
  - **一句话介绍**：将行业经验沉淀为"场景 + Prompt + Skill"资产，通过智能匹配与自我进化，为企业客户提供开箱即用的 AI 解决方案。
  - **核心差异化优势**：
    - vs 通用 AI 平台（如 ChatGPT）：行业场景化、企业级安全、可控可定制
    - vs 传统 workflow 平台：Agent 自主决策、自我进化、低配置成本
    - vs 定制化开发：资产复用、快速交付、持续优化


- **2.2 企业角色与权限体系**
  - **企业租户（Tenant）**：多租户隔离，支持不同企业/部门独立配置场景、Prompt、Skill（v0.8+ 规划）。
  - **管理员 / 平台运营者**（企业侧）：
    - 场景库管理：创建/编辑/发布场景，配置场景 Prompt、绑定 Skill 与工具
    - 用户权限管理：为团队成员分配可用场景、查看使用统计、配置个性化参数
    - 知识资产管理：维护企业私有 Prompt 模板、Skill 工具库
    - 数据洞察：查看团队使用情况、效果评估、成本分析
  - **普通用户 / 业务人员**（企业员工）：
    - 对话式交互：提问、生成文档/报告/PPT/代码、数据分析
    - 场景化引导：自动匹配业务场景，享受领域专业化服务
    - 反馈与纠偏：点赞/点踩/纠正反馈，帮助系统自我进化

- **2.3 典型行业应用场景**
  - **水利规划局**：
    - 工程设计场景：水利方案智能生成、图纸解读、工程量计算
    - 数据分析场景：水文数据分析、水资源评估、防汛预测报告
    - 监管报表场景：水利工程进度监控、质量检查报告、合规性审查
    - 办公场景：政策文件解读、公文拟稿、会议纪要生成
  - **宁夏交建（交通建设）**：
    - 施工管理场景：施工方案优化、进度计划生成、质量安全报告
    - 文档管理场景：合同审查、工程资料整理、竣工报告生成
  - **标书写作通用场景**：
    - 技术标撰写：根据招标需求自动生成技术方案、实施方案、人员配置
    - 商务标生成：报价计算、成本分析、商务条款审查
    - 资质文件整理：自动匹配资质要求、生成资质证明文件目录
    - 合规性检查：对照招标文件要求，检查标书完整性与符合性
    - 多格式输出：生成 Word/PDF 格式标书，支持模板快速套用
  - **配图**：[📊 行业-场景矩阵图](./diagrams/industry_scenario_matrix.html)，展示不同客户的典型应用场景与对应 Skill。

- **2.4 功能清单（普通用户视角）**
  - **对话与会话管理**：
    - 发起新对话、多轮交互、上下文记忆
    - 历史会话查看、搜索、收藏、导出
    - 场景标签自动标注，便于回溯与复用
  - **智能场景匹配**：
    - 根据自然语言问题，自动匹配最合适的业务场景
    - 支持场景切换与手动指定
    - 通用场景兜底，保证"有问必答"
  - **技能 / 工具调用**：
    - 对用户透明：用户无需了解技术细节，自然语言即可调用
    - 支持技能串行/并行调用，复杂任务自动编排
    - 实时展示工具执行进度与结果
  - **反馈与纠正**：
    - 点赞/点踩：快速反馈满意度
    - 纠正反馈：指出回答错误，提供正确答案，系统学习改进
    - 重生成：对不满意的结果重新生成
  - **工作区与协作**：
    - 生成结果保存到个人工作区
    - 支持分享给团队成员（v0.8+）
    - 历史记录与版本管理
  - **配图**：[🎯 用户旅程地图](./diagrams/user_journey_map.html)，从登录 → 选择场景/自动匹配 → 对话交互 → 获得结果 → 反馈优化。

  <details>
  <summary>📸 前端界面截图（用户视角）</summary>

  **需要包含的界面**：
  - 主对话界面：展示场景匹配、对话输入、流式响应
  - 历史会话列表：展示会话管理、搜索、场景标签
  - 反馈交互界面：展示点赞/点踩/纠正功能
  - 工具调用展示：展示工具执行进度和结果

  !用户聊天图 [用户界面截图](./screenshots/WechatIMG465.png)

  </details>

- **2.5 功能清单（管理员视角）**
  - **场景管理（BusinessScenario）**：
    - 创建/编辑/删除/发布场景，配置 `category`、`meta`、场景 Prompt、`is_default`
    - 场景版本管理：A/B 测试、灰度发布
    - 场景效果分析：使用量、满意度、转化率统计
  - **系统 Prompt 管理**：
    - 维护通用 Prompt 模板库（可复用、可继承）
    - Prompt 版本控制与回滚
    - Prompt 效果对比分析
  - **技能管理（Skill）**：
    - 技能内容编辑、分类、可见性控制（`is_public` + `created_by`）
    - 技能与场景绑定、技能组合编排
    - 技能执行日志与性能监控
  - **用户配置与场景授权**：
    - 为用户/团队配置可用场景列表
    - 用户个性化参数配置（温度、输出格式等）
    - 批量导入/导出用户配置
  - **数据洞察与优化**：
    - 用户级偏好分析：了解用户需求与行为模式
    - Session 级偏好分析：追踪会话级决策路径
    - 会话与工具使用统计：高频场景、热门技能、问题类型分布
    - 反馈分析：点踩原因分析、纠正内容挖掘
  - **配图**：[📊 管理后台信息架构图](./diagrams/admin_info_architecture.html)，展示场景 / Prompt / Skill / 用户配置 / 数据分析的关系框图。

  > **📸 前端界面截图占位符（管理员视角）**
  >
  > **需要包含的界面**：
  > - 场景管理界面：展示场景列表、创建/编辑表单、配置项
  > - Prompt管理界面：展示Prompt模板库、版本管理、A/B测试
  > - 数据洞察界面：展示用户偏好分析、使用统计图表、反馈分析
  > - 用户配置界面：展示场景授权、个性化参数配置
  >
  > **建议截图位置**：`./screenshots/admin_interface_01.png`

- **2.6 关键交互示意**
  - **用户侧：从提问到获得结果的完整流程**
    - 进入 AI 助手 → 输入自然语言问题 → 系统自动场景匹配 → 展示匹配场景（用户可切换） → 组合 Prompt + 调用 Skill → 流式返回结果 → 用户反馈 → 系统自我进化
    - **关键体验点**：
      - 场景匹配准确率（目标 ≥85%）
      - 首字响应时间（目标 <2 秒）
      - 结果满意度（目标 ≥90%）
  - **管理员侧：从创建场景到上线运营的流程**
    - 进入管理中心 → 资源配置 → 创建新场景 → 编写场景 Prompt → 绑定 Skill 与工具 → 配置元数据（分类/标签） → 预览测试 → 发布 → 为用户/团队授权 → 监控效果 → 持续优化
    - **关键体验点**：
      - 场景配置便捷性（目标 <15 分钟完成一个场景）
      - 测试验证效率（支持沙盒测试、A/B 对比）
      - 数据洞察深度（可视化报表、趋势分析、异常告警）
  - **配图**：
    - 用户侧：[🔄 用户交互流程图](./diagrams/user_interaction_flow.html)，标注关键体验点
    - 管理员侧：[📊 管理员泳道图](./diagrams/admin_swimlane.html)，展示从需求分析到上线运营的全流程

---

### 三、技术架构概览（How - 企业级技术方案）

- **3.1 整体架构设计原则**
  - **企业级安全**：数据隔离、权限控制、审计日志、加密存储
  - **高可用性**：服务冗余、故障自动恢复、降级策略
  - **可扩展性**：水平扩展能力，支持从单租户到多租户的平滑演进
  - **开放集成**：标准化 API，支持与企业现有系统集成（SSO、ERP、CRM、数据湖）
  - **可观测性**：全链路日志、监控告警、性能分析、成本追踪

- **3.2 分层架构图**
  - **接入层**：
    - Web 前端：React Console（ChatInterface / SessionHistory / AdminDashboard / ResourceCenter）
    - API Gateway：统一 API 入口、认证鉴权、限流熔断、日志审计
  - **应用层**：
    - FastAPI 服务：Agent API / Platform API / Admin API
    - 核心服务模块：
      - AgentService：Agent 生命周期管理、模型调用、工具编排
      - ScenarioMatcher：基于 LLM 的智能场景匹配
      - ScenarioProvider：用户可用场景计算与缓存
      - ConfigurationManager：多层级配置合并（Request > Session > User > Scenario > Global）
      - PromptComposer：动态 Prompt 组装（系统 Prompt + 场景 Prompt + 用户偏好）
      - PromptEvolver：Prompt 进化引擎，注入学习到的偏好
      - PreferenceLearner：用户偏好学习引擎（离线分析 + 实时更新）
      - FeedbackCollector：反馈数据采集与清洗
  - **数据层**：
    - 关系型数据库：SQLite（开发）/ PostgreSQL（生产，支持多租户 schema 隔离）
    - 缓存层：Redis（Session 缓存、偏好缓存、场景匹配结果缓存）
    - 文件存储：MinIO / S3（上传文件、生成文档、PPT 等）
    - 向量数据库：ChromaDB / Qdrant（v0.8+，支持语义搜索与 RAG）
  - **模型与工具层**：
    - LLM 路由：Claude / GPT-4 / 国产大模型（按场景与成本智能路由）
    - Agent SDK：Claude Agent SDK / 自研 Agent 框架
    - 工具生态：MCP 工具、自定义 Skill、第三方 API 集成
    - 任务队列：Celery / Temporal（异步任务、定时任务、工作流编排）
  - **基础设施层**：
    - 容器化：Docker + Kubernetes（生产环境）
    - 服务网格：Istio（微服务通信、流量管理）
    - 监控告警：Prometheus + Grafana + AlertManager
    - 日志中心：ELK / Loki
    - 链路追踪：Jaeger / Zipkin
  - **配图**：[🏗️ 六层架构图](./diagrams/six_layer_architecture.html)，标出关键模块、调用方向、数据流向（可结合 [整体架构图](./diagrams/architecture_overview.html)）。

- **3.3 关键技术组件详解**
  - **ScenarioMatcher（场景匹配引擎）**：
    - 功能：根据用户 Query，在候选场景中智能选择最合适的场景
    - 技术：基于 LLM 的分类模型 + 规则兜底 + 缓存优化
    - 优化：场景 Embedding 预计算 + 向量检索加速（v0.8+）
  - **ConfigurationManager（配置管理中心）**：
    - 功能：按优先级合并多层配置（Request > Session > User > Scenario > Global）
    - 特性：支持配置继承、覆盖、默认值、校验
    - 扩展：支持租户级配置隔离（v0.8+）
  - **PromptComposer + PromptEvolver（Prompt 组合与进化）**：
    - PromptComposer：动态组装多层 Prompt（系统指令 + 场景指令 + 用户偏好 + 历史上下文）
    - PromptEvolver：基于用户偏好数据，动态调整 Prompt 参数（温度、格式、风格等）
    - 优化：Prompt 模板化、变量插值、版本管理、A/B 测试
  - **PreferenceLearner + FeedbackCollector（自我进化核心）**：
    - FeedbackCollector：采集用户反馈（点赞/点踩/纠正/重生成）
    - PreferenceLearner：
      - 实时模式：从单个 Session 学习短期偏好
      - 离线模式：批量分析历史反馈，提取长期偏好模式
      - 技术方案：规则引擎 + LLM 分析 + 机器学习分类（v0.8+）
  - **多租户隔离组件（v0.8+）**：
    - 租户识别：基于域名 / 子路径 / API Key
    - 数据隔离：Schema 隔离 / Row-level Security
    - 资源配额：QoS 限流、存储配额、模型调用量限制
  - **配图**：[🔄 核心组件交互图](./diagrams/core_component_interaction.html)，用方块 + 箭头标注各组件的数据流与依赖关系，突出 Prompt 链路与自我进化闭环。

- **3.4 关键数据模型**
  - **核心业务模型**：
    - Session：会话（租户 ID、用户 ID、场景 ID、创建时间、状态）
    - Message：消息（Session ID、角色、内容、工具调用、时间戳）
    - ConversationTurnConfig：对话轮次配置快照（用于可追溯性与复盘）
  - **场景与配置模型**：
    - BusinessScenario：业务场景（租户 ID、分类、元数据、Prompt、技能绑定、是否默认）
    - SystemPrompt：系统 Prompt 模板（租户 ID、版本、内容、变量）
    - Skill：技能（租户 ID、名称、内容、分类、可见性、创建者）
  - **用户与权限模型**：
    - UserConfig：用户配置（租户 ID、用户 ID、可用场景列表、个性化参数）
    - UserScenarioConfig：用户-场景关联配置（场景级覆盖参数）
    - Tenant：租户（企业信息、配额、计费配置、状态）
  - **反馈与进化模型**：
    - UserFeedback：用户反馈（消息 ID、反馈类型、纠正内容、时间戳）
    - UserPreferencesCache：用户偏好缓存（用户 ID、偏好维度、偏好值、置信度）
    - SessionPreferences：会话偏好（Session ID、临时偏好、生命周期）
    - UserBehaviorStats：用户行为统计（用户 ID、场景使用频次、技能使用统计、时间分布）
  - **审计与日志模型**：
    - AuditLog：操作审计（租户 ID、用户 ID、操作类型、资源、IP、时间戳）
    - SystemMetrics：系统指标（QPS、延迟、错误率、成本）

---

### 四、核心流程拆解（How - 关键业务链路）

- **4.1 用户对话主链路（端到端响应流程）**
  - **接口**：`POST /api/v1/session/query/stream`（前端统一入口）
  - **完整步骤**：
    1. **身份认证与鉴权**：验证 JWT Token / API Key，识别租户 ID 与用户 ID
    2. **会话管理**：解析或创建 Session，加载历史上下文（最近 N 轮对话）
    3. **场景候选计算**：ScenarioProvider 计算用户可用场景列表（默认场景 + 公共场景 + 用户授权场景），从缓存加载
    4. **智能场景匹配**：ScenarioMatcher 根据用户 Query，在候选场景中选择最合适场景（LLM 分类 + 规则兜底 + 缓存加速）
    5. **配置合并**：ConfigurationManager 按优先级合并配置（Request > Session > User > Scenario > Global），生成最终配置
    6. **Prompt 组装**：PromptComposer 组装多层 Prompt（系统指令 + 场景指令 + 用户偏好 + 历史上下文 + 工具说明）
    7. **Agent 执行**：AgentService 调用 Claude Agent SDK，执行模型推理与工具调用（Skill/MCP）
    8. **流式返回**：通过 SSE 流式返回 Token，前端实时渲染 Markdown、工具调用进度
    9. **持久化**：异步保存消息记录、配置快照、工具调用结果到数据库
    10. **埋点上报**：记录 QPS、延迟、Token 消耗、成本等指标到监控系统
  - **性能目标**：
    - 场景匹配延迟：<200ms（P99）
    - 首字响应时间（TTFT）：<2 秒（P99）
    - 总响应时间：取决于模型与工具调用（通常 5-30 秒）
  - **配图**：[🔄 从前端输入到模型调用的完整时序图](./diagrams/conversation_flow.html)，标注关键节点与耗时。

- **4.2 自我进化链路（反馈驱动的持续优化）**
  - **反馈采集**：
    - 前端：用户点击点赞/点踩/纠正/重生成按钮
    - API：`POST /api/v1/feedback`（消息 ID、反馈类型、纠正内容、评分）
    - 存储：FeedbackCollector 写入 `user_feedback` 表，标记时间戳与用户 ID
  - **偏好学习**（异步批处理）：
    - 实时模式（Session 级）：PreferenceLearner 从单个 Session 的反馈中提取短期偏好（如风格偏好、格式偏好），写入 `session_preferences`
    - 离线模式（用户级）：CronJob 定期（如每小时/每天）批量分析 `user_feedback`，聚合长期偏好模式，写入 `user_preferences_cache`
    - 技术方案：
      - 规则引擎：常见偏好模式（如"喜欢简洁回答"、"喜欢表格格式"）
      - LLM 分析：对纠正反馈进行语义分析，提取隐含偏好
      - 机器学习（v0.8+）：训练分类模型，预测用户偏好
  - **Prompt 进化**：
    - PromptComposer 读取用户偏好（UserPreferencesCache + SessionPreferences）
    - PromptEvolver 将偏好注入系统 Prompt（如调整温度、设定输出格式、注入风格约束）
    - 下次对话自动生效，无需人工干预
  - **效果评估**：
    - 离线评估：定期计算满意度提升率、点踩率下降趋势
    - 在线 A/B 测试：对比启用偏好学习前后的用户满意度
  - **配图**：[🔄 环形闭环图](./diagrams/self_evolution_loop.html)，突出"反馈 → 学习 → 进化 → 验证"的持续优化循环。

- **4.3 企业客户接入流程（从签约到上线）**
  - **阶段一：需求分析与方案设计**（1-2 周）
    - 与客户对接人沟通，梳理业务场景与需求
    - 评估现有场景库的复用程度，识别定制化需求
    - 设计技术方案：数据集成方案、SSO 对接、私有化部署/云端部署
  - **阶段二：租户初始化与配置**（2-3 天）
    - 在系统中创建租户（Tenant），分配租户 ID 与 API Key
    - 配置租户参数：资源配额（QPS、存储、调用量）、计费模式
    - 初始化租户管理员账号，配置初始场景与 Skill
  - **阶段三：场景定制与集成**（1-2 周，视定制化程度）
    - 复用场景库：从公共场景库中挑选适用场景，一键复制到租户空间
    - 场景定制：根据客户需求调整场景 Prompt、绑定客户专属 Skill
    - 系统集成：对接客户 SSO（如 LDAP / OAuth2 / SAML）、数据源（如 ERP/CRM）、知识库
  - **阶段四：测试与培训**（3-5 天）
    - 功能测试：验证场景匹配、工具调用、权限控制
    - 性能测试：压测 QPS、并发、响应时间
    - 安全测试：权限隔离、数据加密、审计日志
    - 用户培训：为最终用户提供使用手册、视频教程、现场培训
  - **阶段五：上线与运营支持**（持续）
    - 灰度发布：先小范围试点，收集反馈后全面推广
    - 监控告警：配置租户级监控，异常情况及时告警
    - 运营支持：定期分析使用数据，优化场景与 Prompt
  - **关键里程碑**：从签约到上线通常 4-6 周（传统定制化开发需 2-3 个月）
  - **配图**：[📊 企业客户接入流程图](./diagrams/customer_onboarding_flow.md)

- **4.4 数据安全与权限控制流程**
  - **认证流程**：
    - 用户登录：支持用户名密码 / SSO（OAuth2 / LDAP / SAML）
    - Token 颁发：JWT Token，包含租户 ID、用户 ID、角色、权限、过期时间
    - Token 刷新：Refresh Token 机制，支持无感刷新
  - **鉴权流程**：
    - API 层：API Gateway 验证 Token 签名与有效期
    - 业务层：检查用户权限（如访问场景、修改配置、查看数据）
    - 数据层：Row-level Security，确保用户只能访问授权数据
  - **数据隔离**：
    - 租户级隔离：不同租户的数据存储在独立 Schema 或表中
    - 场景级隔离：用户只能访问被授权的场景
    - 敏感数据脱敏：日志中隐藏敏感信息（如身份证号、手机号）
  - **审计日志**：
    - 记录所有敏感操作：登录、场景修改、数据导出、配置变更
    - 日志内容：操作人、操作时间、操作类型、资源、IP、结果
    - 日志留存：按合规要求保留（如至少 6 个月）
  - **配图**：[🔒 安全流程图](./diagrams/security_flow.html)，展示认证 → 鉴权 → 访问控制 → 审计的完整链路。

- **4.5 场景与 Skill 快速扩展流程**
  - **场景扩展**：
    1. 管理员在后台创建新场景，填写场景名称、分类、描述、Prompt
    2. 绑定所需 Skill 与工具，配置场景参数（温度、Max Tokens 等）
    3. 配置场景可见性（公共场景 / 私有场景）与默认状态
    4. 测试验证：使用测试账号验证场景匹配与执行效果
    5. 发布场景：一键发布到生产环境，授权给目标用户/团队
    6. 监控效果：查看使用统计、满意度，持续优化
  - **Skill 开发**：
    - **MCP 工具**：遵循 MCP 协议，封装为标准工具（如数据库查询、API 调用）
    - **自定义 Skill**：编写 Python 函数，注册到 Skill 仓库，支持复杂业务逻辑
    - **技能编排**：支持技能串联（如"数据查询 → 分析 → 生成报告"）
  - **复用与共享**：
    - 场景市场：支持将场景发布到公共场景库，供其他租户复用
    - Skill 市场：支持将 Skill 发布到 Skill 市场，形成生态
  - **目标**：新场景从设计到上线 <1 天（传统 workflow 开发需 1-2 周）
  - **配图**：[🚀 场景扩展流程图](./diagrams/scenario_extension_flow.html) + [💻 Skill 开发示例](./diagrams/skill_development_example.html)。

---

### 五、团队分工与演进计划（Who & Next）

- **5.1 团队分工建议**
  - **前端团队**：
    - 负责 Chat 界面、SessionHistory、AdminDashboard、ResourceCenter 等交互与视觉
    - 实现偏好可视化、工具调用进度展示、使用统计图表等组件
    - 优化流式响应体验，提升首字响应时间与交互流畅度
    - 支持多租户 UI 主题定制（v0.8+）
  - **后端团队**：
    - 负责 API 设计与实现、数据模型、服务模块（ScenarioMatcher / PromptComposer / PreferenceLearner 等）
    - 负责性能优化、日志与审计、数据库迁移与扩展
    - 实现企业级特性：多租户隔离、权限控制、SSO 集成、配额管理
    - 构建监控告警体系，保障系统稳定性与可观测性
  - **算法 / 调优团队**：
    - 负责 ScenarioMatcher 和 PreferenceLearner 的 Prompt 设计与优化
    - 设计评估指标与离线评估流程，验证自我进化效果
    - 探索多模型路由策略，平衡效果与成本
    - 研究行业场景最佳实践，沉淀场景库与 Skill 库
  - **产品 / 运营团队**：
    - 梳理行业需求，设计产品功能与交互流程
    - 收集用户反馈，规划产品迭代路线
    - 编写用户文档、培训材料，支持客户成功
    - 运营场景库与 Skill 市场，打造生态
  - **售前 / 解决方案团队**：
    - 配合销售团队，参与客户需求分析与方案设计
    - 撰写技术方案 PPT、演示 Demo，支持客户 PoC
    - 总结行业最佳实践，反哺产品团队
  - **运维 / SRE 团队**：
    - 负责部署架构（私有化部署 / 云端部署）、容器化与编排
    - 监控系统健康度，处理故障与告警
    - 优化成本，提升资源利用率
  - **配图**：[👥 团队协作矩阵图](./diagrams/team_collaboration_matrix.html)，标注各团队在项目中的职责边界与协作关系。

- **5.2 近期里程碑（v0.7.1 → v0.7.2-dev → v0.8）**
  - **v0.7.1（当前版本）**：
    - ✅ 基础对话能力：多轮对话、历史会话、流式响应
    - ✅ 场景体系：场景管理、智能匹配、场景授权
    - ✅ Skill 体系：Skill 管理、工具调用、MCP 集成
    - ✅ 自我进化 V1：反馈采集、偏好学习、Prompt 进化
    - ✅ 反馈交互：点赞/点踩/纠正/重生成
  - **v0.7.2-dev（下一个迭代）**：
    - 🚧 偏好可视化：用户偏好面板、管理员偏好洞察
    - 🚧 更多业务场景：金融、制造、政务、医疗等行业场景库
    - 🚧 管理后台完善：场景效果分析、A/B 测试、批量导入导出
    - 🚧 性能优化：缓存策略、并发优化、成本控制
    - 🚧 用户体验：快捷指令、模板库、协作功能
  - **v0.8（企业级版本）**：
    - 📋 多租户支持：租户隔离、配额管理、计费系统
    - 📋 SSO 集成：OAuth2 / LDAP / SAML
    - 📋 企业级安全：审计日志、数据加密、权限细化
    - 📋 私有化部署：Docker 镜像、Kubernetes 部署方案
    - 📋 API 生态：开放 API、SDK、Webhook
  - **配图**：[📅 Roadmap 时间线](./diagrams/roadmap_timeline.html)，标注 v0.7.1 / v0.7.2 / v0.8 的里程碑、交付时间、负责人。

- **5.3 长期规划与愿景（v0.9+）**
  - **产品层面**：
    - 引入团队级偏好与模板库，支持企业知识沉淀
    - 支持多模型智能路由（Claude / GPT-4 / 国产大模型），按场景与成本动态选择
    - 自动生成场景与 Skill 草稿，降低配置成本（基于历史数据与行业知识库）
    - 构建 AI Agent 市场，支持场景与 Skill 的交易与复用
  - **技术层面**：
    - 引入 RAG（检索增强生成），支持企业知识库问答
    - 支持多模态：图片、语音、视频的理解与生成
    - 分布式 Agent 协作：多个 Agent 协同完成复杂任务
    - 模型微调（Fine-tuning）：基于企业数据微调专属模型
  - **商业层面**：
    - SaaS 化运营：订阅制、按量计费、私有化部署 license
    - 行业解决方案：推出金融版、制造版、政务版等垂直产品
    - 伙伴生态：与行业 ISV 合作，共建场景库与 Skill 库
    - 国际化：支持多语言、多区域部署
  - **组织层面**：
    - 建立客户成功团队（CSM），负责客户 Onboarding、培训、续约
    - 建立解决方案团队（SA），负责售前方案设计、PoC 支持
    - 建立行业专家团队，沉淀行业最佳实践
  - **配图**：
    - [📈 产品演进图](./diagrams/product_evolution.html)：从 MVP 到企业级平台到生态平台的演进路径
    - [💰 商业模式图](./diagrams/business_model.html)：订阅制 + 按量计费 + 私有化部署 + 生态分成

- **5.4 成功指标与衡量标准**
  - **产品指标**：
    - 场景匹配准确率：≥85%（v0.7.1），≥90%（v0.8）
    - 用户满意度：≥85%（点赞率），≤5%（点踩率）
    - 首字响应时间：<2 秒（P99）
    - 系统可用性：≥99.5%（SLA）
  - **业务指标**：
    - 单客户交付周期：从 2-3 个月缩短到 4-6 周
    - 场景复用率：从 20% 提升到 80%
    - 客户续约率：≥90%
    - 客户 NPS：≥50
  - **成本指标**：
    - 单项目交付成本：从 30-50 万降至 5-10 万
    - 人效提升：人均交付客户数从 2-3 个/年提升到 8-10 个/年
    - 模型调用成本：通过缓存、路由优化降低 30%+
  - **配图**：[📊 指标仪表盘](./diagrams/metrics_dashboard.html)，展示目标值与当前值，标注改进措施。

---

### 六、总结与行动建议（Summary & Actions）

- **6.1 核心价值主张**
  - **对客户**：
    - 降低 AI 应用门槛：开箱即用的行业场景，无需技术背景
    - 提升业务效率：自动化重复工作，释放人力资源
    - 持续优化改进：系统自我进化，越用越懂业务
    - 数据安全保障：企业级安全、权限控制、审计合规
  - **对我们**：
    - 降本增效：交付成本降低 70%+，人效提升 3-4 倍
    - 知识资产化：行业经验沉淀为可复用场景与 Skill
    - 规模化扩展：从项目制到平台化，支持快速复制
    - 竞争壁垒：构建行业场景库，形成差异化优势

- **6.2 关键成功要素**
  - **技术要素**：
    - 高质量场景库：覆盖主流行业场景，确保匹配准确率 ≥85%
    - 流畅体验：首字响应 <2 秒，流式输出无卡顿
    - 稳定可靠：系统可用性 ≥99.5%，故障快速恢复
  - **业务要素**：
    - 深度行业理解：提炼行业最佳实践，设计场景化解决方案
    - 客户成功体系：完善 Onboarding、培训、运营支持
    - 持续迭代优化：基于数据反馈，快速响应需求
  - **组织要素**：
    - 跨团队协作：产品 / 技术 / 销售 / 客服密切配合
    - 敏捷迭代：小步快跑，快速验证与调整
    - 知识沉淀：建立场景库、Skill 库、最佳实践库

- **6.3 风险与挑战**
  - **技术风险**：
    - 场景匹配准确率不达预期：需持续优化 Prompt 与匹配算法
    - 模型成本过高：需通过缓存、路由、模型优化控制成本
    - 并发性能瓶颈：需架构优化、水平扩展、缓存策略
  - **业务风险**：
    - 客户定制化需求过重：需引导客户使用标准化场景，控制定制化比例
    - 场景库建设周期长：需分行业逐步沉淀，优先重点行业
    - 客户期望管理：需合理设定期望，避免过度承诺
  - **应对措施**：
    - 技术预研：提前布局关键技术，降低实施风险
    - MVP 验证：小范围试点，验证核心假设后再大规模推广
    - 备选方案：准备降级策略，确保核心功能可用

- **6.4 近期行动建议（Next Steps）**
  - **短期（1-2 个月）**：
    - ✅ 完成 v0.7.1 开发与测试，内部试运行
    - 📌 选择 1-2 个友好客户进行 PoC，验证产品价值
    - 📌 收集用户反馈，优化产品体验与场景匹配
    - 📌 梳理重点行业场景，启动场景库建设
  - **中期（3-6 个月）**：
    - 📌 完成 v0.7.2 开发，上线 10+ 行业场景
    - 📌 签约 3-5 个付费客户，跑通客户接入全流程
    - 📌 建立客户成功团队，完善 Onboarding 与培训体系
    - 📌 启动 v0.8 企业级特性开发（多租户、SSO、审计）
  - **长期（6-12 个月）**：
    - 📌 完成 v0.8 开发，支持私有化部署
    - 📌 场景库覆盖 5+ 重点行业，场景数量 ≥50
    - 📌 客户数 ≥20，续约率 ≥90%
    - 📌 启动生态建设，引入 ISV 合作伙伴
  - **资源需求**：
    - 人力：前端 2 人、后端 3 人、算法 1 人、产品 1 人、运维 1 人
    - 预算：模型调用成本、云资源成本、第三方工具采购
    - 时间：v0.7.2 预计 2 个月，v0.8 预计 4-6 个月

- **6.5 Q&A 预判**
  - **Q：场景匹配准确率如何保证？**
    - A：通过 LLM 分类 + 规则兜底 + 缓存优化，目标准确率 ≥85%。持续收集反馈数据，优化匹配 Prompt 与算法，v0.8 目标提升到 ≥90%。
  - **Q：如何控制模型调用成本？**
    - A：通过缓存策略（减少重复调用）、模型路由（简单场景用小模型）、Token 优化（精简 Prompt）等措施，预计可降低 30%+ 成本。
  - **Q：多租户隔离如何实现？**
    - A：v0.8 将支持租户级数据隔离（Schema 隔离 / Row-level Security）、资源配额管理、计费系统，确保不同租户的数据与资源完全隔离。
  - **Q：如何快速构建行业场景库？**
    - A：优先重点行业（金融、制造、政务），与行业专家合作提炼场景；复用现有 workflow 经验，转化为场景配置；建立场景模板，降低新场景配置成本。
  - **Q：与传统 workflow 方案相比，优势是什么？**
    - A：① 配置成本从 1-2 周降到 <1 天；② Agent 自主决策 vs 固定流程；③ 自我进化 vs 手工调优；④ 知识资产复用率从 20% 提升到 80%。

---

### 附录：参考文档与资源

- **架构图与流程图**：
  - [📊 整体架构图](./diagrams/architecture_overview.html)
  - [🔄 对话流程图](./diagrams/conversation_flow.html)
  - [🔄 自我进化闭环图](./diagrams/self_evolution_loop.html)
  - [🎯 客户接入流程图](./diagrams/customer_onboarding_flow.md)
- **技术文档**：
  - [📖 API 文档](../api/API_REFERENCE.md)
  - [🗄️ 数据模型设计](../data_models/DATABASE_SCHEMA.md)
  - [⚙️ 场景配置指南](../guides/SCENARIO_CONFIGURATION.md)
- **行业案例**：
  - [💰 金融行业解决方案](../case_studies/FINANCE_CASE.md)
  - [🏭 制造业解决方案](../case_studies/MANUFACTURING_CASE.md)
- **培训材料**：
  - [📚 用户操作手册](../training/USER_MANUAL.md)
  - [🔧 管理员配置指南](../training/ADMIN_GUIDE.md)
  - [✅ 客户 Onboarding Checklist](../training/ONBOARDING_CHECKLIST.md)

