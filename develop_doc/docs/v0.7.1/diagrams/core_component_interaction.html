<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ ¸å¿ƒç»„ä»¶äº¤äº’å›¾</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .diagram-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #00BCD4;
            padding-bottom: 10px;
        }
        .description {
            color: #666;
            line-height: 1.6;
            margin: 20px 0;
        }
        .highlight {
            background: #e0f7fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            border-left: 4px solid #00BCD4;
        }
    </style>
</head>
<body>
    <h1>æ ¸å¿ƒç»„ä»¶äº¤äº’å›¾</h1>
    <div class="description">
        <p>å±•ç¤ºæ ¸å¿ƒä¸šåŠ¡ç»„ä»¶ä¹‹é—´çš„æ•°æ®æµä¸ä¾èµ–å…³ç³»ï¼Œçªå‡ºPrompté“¾è·¯ä¸è‡ªæˆ‘è¿›åŒ–é—­ç¯ã€‚</p>
    </div>

    <div class="diagram-container">
        <div class="mermaid">
flowchart LR
    subgraph è¾“å…¥ç«¯
        User[ç”¨æˆ·Query]
        Session[ä¼šè¯ä¸Šä¸‹æ–‡]
    end

    subgraph åœºæ™¯åŒ¹é…
        SM[ScenarioMatcher<br/>åœºæ™¯åŒ¹é…å™¨]
        SP[ScenarioProvider<br/>åœºæ™¯æä¾›è€…]
    end

    subgraph é…ç½®ç®¡ç†
        CM[ConfigurationManager<br/>é…ç½®ç®¡ç†å™¨]
        SC[åœºæ™¯é…ç½®]
        UC[ç”¨æˆ·é…ç½®]
        GC[å…¨å±€é…ç½®]
    end

    subgraph Promptå¼•æ“
        PC[PromptComposer<br/>Promptç»„åˆå™¨]
        PE[PromptEvolver<br/>Promptè¿›åŒ–å™¨]
        UP[ç”¨æˆ·åå¥½]
    end

    subgraph Agentæ‰§è¡Œ
        AS[AgentService<br/>AgentæœåŠ¡]
        LLM[å¤§æ¨¡å‹]
        Tools[å·¥å…·/Skill]
    end

    subgraph åé¦ˆè¿›åŒ–
        FC[FeedbackCollector<br/>åé¦ˆæ”¶é›†å™¨]
        PL[PreferenceLearner<br/>åå¥½å­¦ä¹ å™¨]
    end

    User --> SM
    Session --> SM
    SP --> SM
    SM --> CM
    SC --> CM
    UC --> CM
    GC --> CM
    CM --> PC
    UP --> PE
    PE --> PC
    PC --> AS
    AS --> LLM
    AS --> Tools
    LLM --> AS
    AS --> FC
    FC --> PL
    PL --> UP
    UP -.ä¼˜åŒ–å¾ªç¯.-> PE

    style åœºæ™¯åŒ¹é… fill:#e3f2fd
    style é…ç½®ç®¡ç† fill:#fff3e0
    style Promptå¼•æ“ fill:#e8f5e9
    style Agentæ‰§è¡Œ fill:#fce4ec
    style åé¦ˆè¿›åŒ– fill:#f3e5f5
        </div>
    </div>

    <div class="highlight">
        <h3>ğŸ”„ è‡ªæˆ‘è¿›åŒ–é—­ç¯</h3>
        <p><strong>æ•°æ®æµå‘</strong>ï¼šç”¨æˆ·åé¦ˆ â†’ FeedbackCollector â†’ PreferenceLearner â†’ UserPreferencesCache â†’ PromptEvolver â†’ PromptComposer â†’ ä¸‹æ¬¡å¯¹è¯ä¼˜åŒ–</p>
        <p><strong>å…³é”®ä¼˜åŒ–ç‚¹</strong>ï¼š</p>
        <ul>
            <li>å®æ—¶å­¦ä¹ ï¼šSessionçº§çŸ­æœŸåå¥½ï¼Œå³æ—¶ç”Ÿæ•ˆ</li>
            <li>ç¦»çº¿åˆ†æï¼šç”¨æˆ·çº§é•¿æœŸåå¥½æ¨¡å¼ï¼Œæ‰¹é‡æ›´æ–°</li>
            <li>Promptè¿›åŒ–ï¼šè‡ªåŠ¨è°ƒæ•´æ¸©åº¦ã€æ ¼å¼ã€é£æ ¼ç­‰å‚æ•°</li>
        </ul>
    </div>
</body>
</html>
