# 技能市场开发计划

> 基于 `v0.8-feat-doc.md` 的完整开发计划
>
> 最后更新：2026-01-14

# 技能市场架构开发计划 V0.8

## 🎯 核心设计原则

### 原则0: 不要改变现有问答逻辑
如果需要修改，需要和用户确认

### 原则1：充分复用现有能力
- **复用对话系统**：使用现有的多轮对话机制实现技能调试
- **复用技能系统**：基于现有的技能加载和管理机制
- **复用数据库模型**：使用现有的 SkillDB 模型，无需大规模重构

### 原则2：对话式构建体验
- **自然交互**：通过对话引导用户创建技能，而非复杂表单
- **实时调试**：在创建过程中即可测试技能效果
- **所见即所得**：立即看到技能生成结果

### 原则3：渐进式发布
- **草稿阶段**：创建技能但仅自己可见
- **调试阶段**：在对话中测试和优化
- **发布阶段**：发布到市场，所有人可用

### 原则4：开放生态
- **技能模板**：提供常见技能模板，降低创建门槛
- **技能评分**：用户可为技能评分和反馈
- **推荐算法**：基于使用统计推荐热门技能

---

---

## 📊 开发进度总览

- **总任务数**：56
- **已完成**：1
- **进行中**：0
- **未开始**：55
- **完成率**：1.8%

---

## 🎯 Phase 0: 文档准备（已完成）- 优先级：P0

### 0.1 核心集成方案文档

- [x] **DOC-001**: 补充核心集成方案到架构文档
  - **状态**: 已完成
  - **优先级**: P0
  - **描述**: 在 v0.8-feat-doc.md 中添加"核心集成方案"章节，详细说明如何复用现有对话系统
  - **文件**: `devolop_doc/docs/v0.8/v0.8-feat-doc.md`
  - **添加内容**:
    - 核心原理：Skill的SKILL.md内容 = AI的System Prompt
    - 三个阶段的详细实现流程（创建、调试、使用）
    - 完整流程图和代码示例
    - 关键优势说明
  - **价值**:
    - 明确技术实现路径
    - 确认只需新增20%代码
    - 为开发团队提供清晰指导
  - **完成时间**: 2026-01-14

---

## 🎯 Phase 1: Meta Skill 实现（核心）- 优先级：P0

### 1.1 skill_builder 技能文件

- [ ] **BUILDER-001**: 创建 skill_builder 目录结构
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 在 `backend/.claude/skills/` 下创建 skill_builder 目录
  - **文件**: `backend/.claude/skills/skill_builder/`
  - **依赖**: 无

- [ ] **BUILDER-002**: 编写 skill_builder/SKILL.md
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 编写技能构建器的核心内容，包含对话流程、模板等
  - **文件**: `backend/.claude/skills/skill_builder/SKILL.md`
  - **依赖**: BUILDER-001

- [ ] **BUILDER-003**: 编写 skill_builder/skill.json
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 配置技能元数据、版本、依赖等
  - **文件**: `backend/.claude/skills/skill_builder/skill.json`
  - **依赖**: BUILDER-001

- [ ] **BUILDER-004**: 测试 skill_builder 基础功能
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 在对话中测试 skill_builder 技能是否正常加载和响应
  - **测试用例**:
    - 启动技能构建对话
    - 提供简单需求
    - 验证是否生成技能结构
  - **依赖**: BUILDER-002, BUILDER-003

### 1.2 技能构建服务

- [ ] **BUILDER-005**: 实现 SkillBuilderService 类
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 创建技能构建服务，实现从对话上下文构建技能的核心逻辑
  - **文件**: `backend/services/skill_builder_service.py`
  - **核心方法**:
    - `build_skill_from_conversation()`
    - `_extract_metadata()`
    - `_generate_skill_config()`
    - `_generate_skill_content()`
  - **依赖**: BUILDER-002

- [ ] **BUILDER-006**: 实现技能元数据提取
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 从对话上下文中提取技能名称、描述、分类等元数据
  - **文件**: `backend/services/skill_builder_service.py` (_extract_metadata 方法)
  - **依赖**: BUILDER-005

- [ ] **BUILDER-007**: 实现 skill.json 生成
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 根据提取的元数据生成符合标准的 skill.json 配置
  - **文件**: `backend/services/skill_builder_service.py` (_generate_skill_config 方法)
  - **输出格式**: 标准的 JSON 配置，包含 name, version, description 等
  - **依赖**: BUILDER-006

- [ ] **BUILDER-008**: 实现 SKILL.md 生成
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 根据提取的元数据和对话内容生成完整的 SKILL.md
  - **文件**: `backend/services/skill_builder_service.py` (_generate_skill_content 方法)
  - **输出格式**:
    - Frontmatter (YAML)
    - 技能描述
    - 使用指南
    - 示例代码
  - **依赖**: BUILDER-006

- [ ] **BUILDER-009**: 实现技能保存到数据库
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 将生成的技能保存到 SkillDB 表，初始状态为草稿
  - **文件**: `backend/services/skill_builder_service.py` (_save_skill 方法)
  - **初始状态**: is_public=False, is_default=False
  - **依赖**: BUILDER-007, BUILDER-008

### 1.3 API 端点

- [ ] **BUILDER-010**: 实现技能构建 API
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 创建 `/api/v1/platform/skills/build` POST 端点
  - **文件**: `backend/api/v1/platform.py`
  - **请求模型**: SkillBuildRequest
  - **响应模型**: SkillResponse
  - **依赖**: BUILDER-009

- [ ] **BUILDER-011**: 创建请求/响应模型
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 定义 SkillBuildRequest 和 SkillPublishRequest 模型
  - **文件**: `backend/models/platform.py`
  - **字段**:
    - conversation_context: Dict[str, Any]
    - skill_metadata: Optional[Dict[str, Any]]
    - SkillPublishRequest: is_public, category, tags
  - **依赖**: 无

### 1.4 前端构建界面

- [ ] **BUILDER-012**: 创建技能构建页面
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 创建 `/skill-builder` 页面，提供对话式构建界面
  - **文件**: `frontend/aigc-frontend/pages/skill-builder.tsx`
  - **组件**:
    - 对话界面（复用 ChatInterface）
    - 技能预览
    - 发布确认
  - **依赖**: BUILDER-010

- [ ] **BUILDER-013**: 集成 skill_builder 调用
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 在构建页面调用 build API，发送对话上下文
  - **文件**: `frontend/aigc-frontend/pages/skill-builder.tsx`
  - **API 调用**: `POST /api/v1/platform/skills/build`
  - **依赖**: BUILDER-012

- [ ] **BUILDER-014**: 实现技能预览组件
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 显示生成的 SKILL.md 和 skill.json 内容
  - **文件**: `frontend/aigc-frontend/components/SkillPreview.tsx`
  - **功能**:
    - Markdown 渲染
    - JSON 高亮
    - 复制按钮
  - **依赖**: BUILDER-013

- [ ] **BUILDER-015**: 实现发布确认流程
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 用户确认后调用发布 API，将技能保存为草稿或直接发布
  - **文件**: `frontend/aigc-frontend/pages/skill-builder.tsx`
  - **API 调用**: `POST /api/v1/platform/skills/{id}/publish`
  - **依赖**: BUILDER-014

---

## 🎯 Phase 1.5: 技能模板库（重要）- 优先级：P1

### 1.5.1 模板数据库

- [ ] **TEMPLATE-001**: 创建技能模板数据库表
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建 `skill_templates` 表，存储预定义的技能模板
  - **文件**: `backend/models/database.py`
  - **字段**:
    - id: 主键
    - template_id: 模板ID（如 'data_analysis', 'text_processing'）
    - name: 模板名称
    - description: 模板描述
    - category: 适用分类
    - skill_content_template: SKILL.md 模板内容
    - skill_config_template: skill.json 模板内容
    - is_active: 是否启用
  - **依赖**: 无

- [ ] **TEMPLATE-002**: 实现4个预定义模板
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建4个预定义技能模板
  - **文件**: 数据库迁移脚本
  - **模板**:
    1. 数据分析技能模板
    2. 文本处理技能模板
    3. 工具调用技能模板
    4. 指导框架技能模板
  - **依赖**: TEMPLATE-001

### 1.5.2 模板选择功能

- [ ] **TEMPLATE-003**: 实现模板选择 API
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建 API 获取可用模板列表和单个模板详情
  - **文件**: `backend/api/v1/platform.py`
  - **端点**:
    - `GET /api/v1/platform/skill-templates` - 获取模板列表
    - `GET /api/v1/platform/skill-templates/{template_id}` - 获取模板详情
  - **依赖**: TEMPLATE-002

- [ ] **TEMPLATE-004**: 前端模板选择界面
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 在技能构建页面添加模板选择组件
  - **文件**: `frontend/aigc-frontend/components/TemplateSelector.tsx`
  - **功能**:
    - 模板卡片展示
    - 点击选择模板
    - 模板详情预览
  - **依赖**: TEMPLATE-003

---

## 🎯 Phase 2: 调试功能（核心）- 优先级：P0

### 2.0 调试会话类型扩展

- [ ] **DEBUG-000**: 扩展 SessionDB 支持会话类型
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 扩展 SessionDB 模型，添加 session_type 字段以区分调试会话和正常会话
  - **文件**: `backend/models/database.py`
  - **变更**:
    - 添加字段: `session_type: Mapped[str] = mapped_column(String(20), default='normal', index=True)`
    - 类型枚举: 'normal'（正常会话）, 'debug'（调试会话）, 'test'（测试会话）
  - **目的**:
    - 调试会话不计入用户正常对话统计
    - 调试会话可以单独管理和清理
    - 避免调试对话污染用户历史记录
  - **数据库迁移**: 需要为现有数据添加默认值 'normal'
  - **依赖**: 无

### 2.1 调试服务

- [ ] **DEBUG-001**: 实现 SkillDebugger 类
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 创建技能调试服务，管理调试会话和技能加载
  - **文件**: `backend/services/skill_debugger.py`
  - **核心方法**:
    - `start_debug_session()` - 创建调试会话，session_type='debug'
    - `test_skill()` - 在调试会话中测试技能
    - `_load_skill()` - 加载要调试的技能
    - `_inject_skill_to_session()` - 将技能注入到会话
  - **特殊处理**:
    - 所有调试会话必须标记 session_type='debug'
    - 调试会话ID 建议格式: `debug_skill_{skill_id}_{user_id}_{timestamp}`
  - **依赖**: DEBUG-000

- [ ] **DEBUG-002**: 实现调试会话启动
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 启动专用调试会话，加载要调试的技能
  - **文件**: `backend/services/skill_debugger.py` (start_debug_session 方法)
  - **关键实现**:
    - 创建会话时设置 session_type='debug'
    - 返回格式化的 debug_session_id
    - 记录调试的 skill_id 到 extra_data
  - **返回**: { session_id: str, skill_id: int, message: str }
  - **依赖**: DEBUG-001

- [ ] **DEBUG-003**: 实现技能临时加载
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 将要调试的技能注入到调试会话的 system prompt 中
  - **文件**: `backend/services/skill_debugger.py` (_inject_skill_to_session 方法)
  - **复用**: 现有的 AgentSession 和 resume 机制
  - **依赖**: DEBUG-002

- [ ] **DEBUG-004**: 实现技能测试接口
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 在调试会话中测试技能，返回流式响应
  - **文件**: `backend/services/skill_debugger.py` (test_skill 方法)
  - **复用**: AgentService.query_in_session
  - **依赖**: DEBUG-003

### 2.2 调试 API

- [ ] **DEBUG-005**: 实现调试会话启动 API
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 创建 `/api/v1/platform/skills/{skill_id}/debug` POST 端点
  - **文件**: `backend/api/v1/platform.py`
  - **响应**: { session_id: str, skill_id: int, message: str }
  - **依赖**: DEBUG-002

- [ ] **DEBUG-006**: 实现测试消息发送
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 调试会话使用现有的 `/session/query/stream` API
  - **复用**: `backend/api/v1/endpoints.py` 的现有端点
  - **说明**: 无需新增端点，直接复用现有对话接口
  - **依赖**: 无

### 2.3 前端调试界面

- [ ] **DEBUG-007**: 创建调试页面路由
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 添加 `/skill-debugger/:skillId` 路由
  - **文件**: `frontend/aigc-frontend/App.tsx`
  - **依赖**: 无

- [ ] **DEBUG-008**: 创建调试界面组件
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 创建分屏调试界面（对话 + 技能预览）
  - **文件**: `frontend/aigc-frontend/components/SkillDebugger.tsx`
  - **布局**:
    - 左侧：调试对话（复用 ChatInterface）
    - 右侧：技能内容预览（复用 SkillPreview）
  - **依赖**: DEBUG-007, BUILDER-014

- [ ] **DEBUG-009**: 实现调试会话初始化
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 组件加载时调用 debug API，获取调试会话 ID
  - **文件**: `frontend/aigc-frontend/components/SkillDebugger.tsx`
  - **API 调用**: `POST /api/v1/platform/skills/{skill_id}/debug`
  - **依赖**: DEBUG-005

- [ ] **DEBUG-010**: 集成对话组件
  - **状态**: 未开始
  - **优先级**: P0
  - **描述**: 在调试界面中集成 ChatInterface，使用调试会话 ID
  - **文件**: `frontend/aigc-frontend/components/SkillDebugger.tsx`
  - **复用**: 现有的 ChatInterface 组件
  - **依赖**: DEBUG-009

### 2.4 调试会话过滤和统计

- [ ] **DEBUG-011**: 实现调试会话过滤查询
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 确保在统计和查询用户会话时过滤掉调试会话
  - **文件**:
    - `backend/services/session_manager.py`
    - `backend/api/v1/endpoints.py`
  - **功能**:
    - 会话列表 API 添加参数 `exclude_debug=True`
    - 统计查询时自动过滤 session_type='debug'
    - 用户历史记录只显示正常会话
  - **影响范围**:
    - 会话列表查询
    - 用户统计计算
    - 历史记录展示
  - **依赖**: DEBUG-000

- [ ] **DEBUG-012**: 实现调试会话自动清理
  - **状态**: 未开始
  - **优先级**: P2
  - **描述**: 提供调试会话的自动清理机制，避免占用过多存储空间
  - **文件**: `backend/services/session_manager.py`
  - **清理策略**:
    - 调试会话过期时间：24小时
    - 定时任务：每天清理过期的调试会话
    - 用户手动清理：提供"清空调试会话"按钮
  - **依赖**: DEBUG-000

---

## 🎯 Phase 2.5: 使用统计和启用功能（重要）- 优先级：P1

### 2.5.1 使用统计记录

- [ ] **STATS-001**: 实现技能使用统计记录
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 当用户使用技能时，自动更新使用统计
  - **文件**: `backend/services/skill_usage_tracker.py`
  - **功能**:
    - 自动更新 usage_count
    - 记录 last_used 时间
    - 支持异步批量更新
  - **触发时机**: 技能加载到会话时
  - **依赖**: MARKET-002

- [ ] **STATS-002**: 实现技能使用统计 API
  - **状态**: 未开始
  - **优先级**: P2
  - **描述**: 提供技能使用统计查询接口
  - **文件**: `backend/api/v1/platform.py`
  - **端点**: `GET /api/v1/platform/skills/{skill_id}/stats`
  - **返回**: 使用统计、评分、下载次数等
  - **依赖**: STATS-001

### 2.5.2 启用技能功能

- [ ] **ENABLE-001**: 实现启用技能 API
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 启用技能到当前会话
  - **文件**: `backend/api/v1/platform.py`
  - **端点**: `POST /api/v1/platform/skills/{skill_id}/enable`
  - **功能**:
    - 将技能加载到指定会话
    - 记录使用统计（调用 STATS-001）
    - 返回加载后的会话信息
  - **依赖**: STATS-001

- [ ] **ENABLE-002**: 前端启用按钮
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 在技能卡片和详情页添加启用按钮
  - **文件**:
    - `frontend/aigc-frontend/components/SkillCard.tsx`
    - `frontend/aigc-frontend/pages/skill-detail.tsx`
  - **功能**:
    - 点击启用按钮
    - 调用启用 API
    - 成功提示
  - **依赖**: ENABLE-001

---

## 🎯 Phase 3: 市场功能（重要）- 优先级：P1

### 3.1 数据库扩展

- [ ] **MARKET-001**: 创建技能评分表
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建 `skill_ratings` 表，存储用户对技能的评分
  - **文件**: `backend/models/database.py`
  - **字段**:
    - id: 主键
    - skill_id: 技能ID（外键）
    - user_id: 用户ID（外键）
    - rating: 评分（1-5）
    - comment: 评论内容
    - created_at: 创建时间
  - **约束**: UNIQUE(skill_id, user_id) - 每个用户只能评一次
  - **依赖**: 无

- [ ] **MARKET-002**: 创建技能使用统计表
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建 `skill_usage_stats` 表，统计技能使用情况
  - **文件**: `backend/models/database.py`
  - **字段**:
    - skill_id: 技能ID（主键，外键）
    - usage_count: 使用次数
    - download_count: 下载次数
    - favorite_count: 收藏次数
    - last_used: 最后使用时间
  - **依赖**: 无

- [ ] **MARKET-003**: 创建技能评论表
  - **状态**: 未开始
  - **优先级**: P2
  - **描述**: 创建 `skill_comments` 表，存储用户评论
  - **文件**: `backend/models/database.py`
  - **字段**:
    - id: 主键
    - skill_id: 技能ID（外键）
    - user_id: 用户ID（外键）
    - comment: 评论内容
    - created_at: 创建时间
    - updated_at: 更新时间
  - **依赖**: 无

- [ ] **MARKET-004**: 执行数据库迁移
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建数据库迁移脚本并执行
  - **文件**: 数据库迁移脚本
  - **依赖**: MARKET-001, MARKET-002

### 3.2 市场页面

- [ ] **MARKET-005**: 创建技能市场页面
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建 `/skill-market` 页面
  - **文件**: `frontend/aigc-frontend/pages/skill-market.tsx`
  - **功能**:
    - 技能列表展示
    - 分类筛选
    - 搜索框
    - 排序选项
  - **依赖**: 无

- [ ] **MARKET-006**: 创建技能卡片组件
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建技能卡片，展示技能基本信息
  - **文件**: `frontend/aigc-frontend/components/SkillCard.tsx`
  - **展示内容**:
    - 技能名称
    - 描述
    - 分类标签
    - 评分
    - 使用次数
    - 启用按钮
  - **依赖**: 无

- [ ] **MARKET-007**: 实现技能列表 API
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 扩展现有的列表 API，支持筛选和排序
  - **文件**: `backend/api/v1/platform.py`
  - **端点**: `GET /api/v1/platform/skills` (已存在，需扩展)
  - **新增参数**:
    - category: 分类筛选
    - sort: 排序方式（热门/最新/评分）
    - search: 搜索关键词
  - **依赖**: MARKET-001, MARKET-002

- [ ] **MARKET-008**: 实现分类筛选
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 前端实现分类筛选 UI
  - **文件**: `frontend/aigc-frontend/pages/skill-market.tsx`
  - **功能**:
    - 分类标签
    - 点击筛选
    - 清除筛选
  - **依赖**: MARKET-005

- [ ] **MARKET-009**: 实现搜索功能
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 前端实现搜索框，后端支持模糊搜索
  - **文件**:
    - `frontend/aigc-frontend/pages/skill-market.tsx`
    - `backend/api/v1/platform.py`
  - **搜索字段**: name, description, tags
  - **依赖**: MARKET-007

### 3.3 技能详情

- [ ] **MARKET-010**: 创建技能详情页面
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建 `/skill-market/:skillId` 详情页
  - **文件**: `frontend/aigc-frontend/pages/skill-detail.tsx`
  - **展示内容**:
    - 技能完整信息
    - SKILL.md 内容预览
    - 使用示例
    - 评分和评论
    - 启用/试用按钮
  - **依赖**: 无

- [ ] **MARKET-011**: 实现评分功能
  - **状态**: 未开始
  - **优先级**: P2
  - **描述**: 用户可以为技能评分（1-5星）
  - **文件**:
    - `backend/api/v1/platform.py`
    - `frontend/aigc-frontend/components/SkillRating.tsx`
  - **API**: `POST /api/v1/platform/skills/{skill_id}/rate`
  - **依赖**: MARKET-001

---

## 🎯 Phase 4: 发布和我的技能（重要）- 优先级：P1

### 4.1 发布功能

- [ ] **PUBLISH-001**: 实现发布 API
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建 `/api/v1/platform/skills/{skill_id}/publish` POST 端点
  - **文件**: `backend/api/v1/platform.py`
  - **请求模型**: SkillPublishRequest (在 BUILDER-011 中定义)
  - **功能**:
    - 更新 is_public 状态
    - 更新分类和标签
  - **依赖**: BUILDER-011

- [ ] **PUBLISH-002**: 创建发布确认组件
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 用户确认发布信息的弹窗组件
  - **文件**: `frontend/aigc-frontend/components/PublishConfirm.tsx`
  - **表单字段**:
    - 技能名称
    - 描述
    - 分类
    - 标签
    - 是否公开
  - **依赖**: 无

- [ ] **PUBLISH-003**: 集成发布流程
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 在技能构建页面和我的技能页面集成发布功能
  - **文件**:
    - `frontend/aigc-frontend/pages/skill-builder.tsx`
    - `frontend/aigc-frontend/pages/my-skills.tsx`
  - **依赖**: PUBLISH-001, PUBLISH-002

### 4.2 我的技能管理

- [ ] **MYSKILLS-001**: 创建我的技能页面
  - **状态**: 未开始
  - **优先级**: P1
  - **描述**: 创建 `/my-skills` 页面，管理用户创建的技能
  - **文件**: `frontend/aigc-frontend/pages/my-skills.tsx`
  - **功能**:
    - 技能列表（仅自己创建的）
    - 编辑按钮
    - 删除按钮
    - 调试按钮
    - 发布按钮
  - **依赖**: 无

- [ ] **MYSKILLS-002**: 实现编辑功能
  - **状态**: 未开始
  - **优先级**: P2
  - **描述**: 允许用户编辑已创建的技能
  - **文件**:
    - `frontend/aigc-frontend/pages/my-skills.tsx`
    - `backend/api/v1/platform.py` (已有 PUT /skills/{id})
  - **功能**:
    - 编辑 SKILL.md
    - 编辑 skill.json
    - 保存修改
  - **依赖**: 无

- [ ] **MYSKILLS-003**: 实现删除功能
  - **状态**: 未开始
  - **优先级**: P2
  - **描述**: 允许用户删除自己创建的技能
  - **文件**:
    - `frontend/aigc-frontend/pages/my-skills.tsx`
    - `backend/api/v1/platform.py` (已有 DELETE /skills/{id})
  - **确认**: 删除前需用户确认
  - **依赖**: 无

---

## 🎯 Phase 5: 生态层功能（可选）- 优先级：P2

### 5.1 推荐算法

- [ ] **RECOMMEND-001**: 实现技能推荐算法
  - **状态**: 未开始
  - **优先级**: P2
  - **描述**: 基于使用统计、用户偏好等推荐技能
  - **文件**: `backend/services/skill_recommender.py`
  - **策略**:
    - 基于热门度推荐（使用次数）
    - 基于评分推荐
    - 基于用户行为推荐
  - **API**: `GET /api/v1/platform/skills/recommended`
  - **依赖**: STATS-001

### 5.2 审核机制

- [ ] **REVIEW-001**: 实现技能审核机制
  - **状态**: 未开始
  - **优先级**: P2
  - **描述**: 管理员审核公开技能
  - **文件**: `backend/services/skill_reviewer.py`
  - **功能**:
    - 技能提交审核队列
    - 审核通过/拒绝
    - 审核记录
  - **API**:
    - `POST /api/v1/admin/skills/{skill_id}/review`
    - `GET /api/v1/admin/skills/pending`
  - **依赖**: 无

### 5.3 举报机制

- [ ] **REPORT-001**: 实现技能举报功能
  - **状态**: 未开始
  - **优先级**: P2
  - **描述**: 用户可以举报不当技能
  - **文件**:
    - `backend/api/v1/platform.py`
    - `frontend/aigc-frontend/components/ReportSkill.tsx`
  - **API**: `POST /api/v1/platform/skills/{skill_id}/report`
  - **字段**:
    - reason: 举报原因
    - description: 详细描述
    - user_id: 举报用户
  - **依赖**: 无

---

## 📋 开发优先级说明

- **P0（必须）**: Phase 1（Meta Skill）+ Phase 2（调试功能） - 核心功能，必须实现
- **P1（重要）**: Phase 1.5（模板库）+ Phase 2.5（统计启用）+ Phase 3（市场页面）+ Phase 4（发布管理） - 重要功能，建议实现
- **P2（可选）**: Phase 5（生态层）+ 评分系统 + 高级编辑功能 - 可选功能，后续实现

---

## 🔄 开发顺序建议

### 第一阶段：核心构建（P0）- Week 1

**Day 1-2: Meta Skill 基础**
1. BUILDER-001, BUILDER-002, BUILDER-003（创建 skill_builder 文件）
2. BUILDER-004（测试基础功能）

**Day 3-4: 构建服务**
1. BUILDER-005（SkillBuilderService 类）
2. BUILDER-006, BUILDER-007, BUILDER-008（生成逻辑）
3. BUILDER-009（保存到数据库）

**Day 5: API 和前端**
1. BUILDER-010, BUILDER-011（API 端点）
2. BUILDER-012（构建页面）

### 第二阶段：调试功能（P0）- Week 1-2

**Day 6-7: 调试服务**
1. DEBUG-001, DEBUG-002（SkillDebugger 类）
2. DEBUG-003, DEBUG-004（调试逻辑）

**Day 8-9: API 和界面**
1. DEBUG-005（调试 API）
2. DEBUG-007, DEBUG-008, DEBUG-009, DEBUG-010（调试界面）

### 第三阶段：模板库和统计（P1）- Week 2

**Day 10: 模板库**
1. TEMPLATE-001, TEMPLATE-002（模板数据库）
2. TEMPLATE-003, TEMPLATE-004（模板选择功能）

**Day 11: 使用统计和启用**
1. STATS-001, STATS-002（使用统计）
2. ENABLE-001, ENABLE-002（启用功能）

### 第四阶段：市场功能（P1）- Week 2-3

**Day 12-13: 数据库**
1. MARKET-001, MARKET-002（评分和统计表）
2. MARKET-004（数据库迁移）

**Day 14-15: 市场页面**
1. MARKET-005, MARKET-006（市场页面和卡片）
2. MARKET-007, MARKET-008, MARKET-009（列表 API 和筛选）

**Day 16: 技能详情**
1. MARKET-010（技能详情页）

### 第五阶段：发布和管理（P1）- Week 3

**Day 17-18: 发布功能**
1. PUBLISH-001（发布 API）
2. PUBLISH-002, PUBLISH-003（发布流程）

**Day 19: 我的技能**
1. MYSKILLS-001（我的技能页面）
2. MYSKILLS-002, MYSKILLS-003（编辑和删除）

### 第六阶段：生态层功能（P2，可选）- Week 3-4

**Day 20-22:**
1. RECOMMEND-001（推荐算法）
2. REVIEW-001（审核机制）
3. REPORT-001（举报功能）
4. MARKET-003, MARKET-011（评分系统完善）
5. 全面测试
6. Bug 修复
7. 文档完善

---

## 📊 任务统计

### 按阶段统计
- **Phase 0（文档准备）**: 1个任务 - P0（已完成）
- **Phase 1（Meta Skill）**: 15个任务 - P0
- **Phase 1.5（技能模板库）**: 4个任务 - P1
- **Phase 2（调试功能）**: 12个任务 - P0（新增2个）
- **Phase 2.5（统计和启用）**: 4个任务 - P1
- **Phase 3（市场功能）**: 11个任务 - P1
- **Phase 4（发布管理）**: 6个任务 - P1
- **Phase 5（生态层）**: 3个任务 - P2
- **总计**：56个任务

### 按优先级统计
- **P0（必须）**: 28个任务（Phase 0 + Phase 1 + Phase 2，含1个已完成）
- **P1（重要）**: 25个任务（Phase 1.5 + Phase 2.5 + Phase 3 + Phase 4）
- **P2（可选）**: 3个任务（Phase 5）

---

## 📝 开发注意事项

1. **复用优先**
   - ✅ 优先复用现有的对话系统
   - ✅ 优先复用现有的技能管理 API
   - ✅ 优先复用现有的前端组件

2. **渐进式开发**
   - ✅ 先实现核心构建功能
   - ✅ 再实现调试功能
   - ✅ 然后实现模板和统计
   - ✅ 最后实现市场功能

3. **测试驱动**
   - ✅ 每个功能完成后立即测试
   - ✅ 使用真实对话测试 skill_builder
   - ✅ 使用真实技能测试调试功能

4. **向后兼容**
   - ✅ 不修改现有的技能系统
   - ✅ 不修改现有的对话系统
   - ✅ 只新增，不删除

5. **性能优化**
   - ✅ 调试会话使用缓存
   - ✅ 技能列表使用分页
   - ✅ 搜索使用索引

6. **数据完整性**
   - ✅ 使用统计记录必须在启用技能时自动触发
   - ✅ 模板数据必须预加载到数据库
   - ✅ 评分和评论需要关联到用户和技能

---

**最后更新**: 2026-01-14（开发计划完善，补充遗漏任务）
**当前进度**: 0/53 (0%) - 准备开始开发
**预计周期**: 3-4 周

---

## 📝 可行性验证结论

### ✅ 技术可行性：5/5

- ✅ 现有系统已具备 80% 的基础能力
- ✅ 技能加载机制灵活，支持动态创建
- ✅ 对话系统成熟，可完全复用
- ✅ 数据库模型设计完善，无需大改
- ✅ 前端组件丰富，可快速集成

### ✅ 实现难度：2/5

- 核心功能（增删改查）：**已完成** ✅
- Meta_skill 构建：**中等难度**（需要精心设计提示词）
- 对话调试：**简单**（直接复用现有会话机制）
- 市场页面：**简单**（前端组件开发）
- 模板库：**简单**（数据库 + 选择界面）
- 使用统计：**简单**（计数器更新）

### ✅ 开发周期：3-4周

- Week 1: Meta Skill + 调试功能（P0）
- Week 2: 模板库 + 统计启用 + 市场页面（P1）
- Week 3: 发布功能 + 我的管理（P1）
- Week 4: 生态层 + 测试优化（P2，可选）

### ✅ 风险评估：低

**潜在风险**：
1. **技能质量** - 用户创建的技能可能质量不高
   - **缓解**：提供模板库、审核机制、评分系统

2. **安全风险** - 恶意技能可能包含有害内容
   - **缓解**：审核机制、举报系统、权限控制

3. **性能影响** - 动态加载技能可能影响性能
   - **缓解**：缓存机制、懒加载、限流

4. **数据一致性** - 使用统计可能记录不准确
   - **缓解**：异步批量更新、定时校验

---

## 🚀 下一步行动

1. ✅ **创建开发分支**: `git checkout -b feat/skill-market`
2. ✅ **开始 Phase 1**: 从 BUILDER-001 开始实现
3. ✅ **每日进度更新**: 在本文档中更新任务状态

---

**开始开发吧！🎉**
