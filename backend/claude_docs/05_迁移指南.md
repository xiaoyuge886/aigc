# 迁移到 Claude Agent SDK

将 Claude Code TypeScript 和 Python SDK 迁移到 Claude Agent SDK 的指南

## 概述

Claude Code SDK 已重命名为 **Claude Agent SDK**，其文档已重新组织。这一变化反映了该 SDK 在构建超越编码任务的 AI 代理方面的更广泛功能。

## 变更内容

| 方面 | 旧版本 | 新版本 |
| --- | --- | --- |
| **包名称 (TS/JS)** | `@anthropic-ai/claude-code` | `@anthropic-ai/claude-agent-sdk` |
| **Python 包** | `claude-code-sdk` | `claude-agent-sdk` |
| **文档位置** | Claude Code 文档 | API 指南 → Agent SDK 部分 |

## 迁移步骤

### 对于 TypeScript/JavaScript 项目

**1. 卸载旧包：**

```bash
npm uninstall @anthropic-ai/claude-code
```

**2. 安装新包：**

```bash
npm install @anthropic-ai/claude-agent-sdk
```

**3. 更新导入：**

将所有导入从 `@anthropic-ai/claude-code` 更改为 `@anthropic-ai/claude-agent-sdk`：

```typescript
// 之前
import { query, tool, createSdkMcpServer } from "@anthropic-ai/claude-code";

// 之后
import {
  query,
  tool,
  createSdkMcpServer,
} from "@anthropic-ai/claude-agent-sdk";
```

### 对于 Python 项目

**1. 卸载旧包：**

```bash
pip uninstall claude-code-sdk
```

**2. 安装新包：**

```bash
pip install claude-agent-sdk
```

**3. 更新导入：**

将所有导入从 `claude_code_sdk` 更改为 `claude_agent_sdk`：

```python
# 之前
from claude_code_sdk import query, ClaudeCodeOptions

# 之后
from claude_agent_sdk import query, ClaudeAgentOptions
```

**4. 更新类型名称：**

将 `ClaudeCodeOptions` 更改为 `ClaudeAgentOptions`：

```python
# 之前
from claude_agent_sdk import query, ClaudeCodeOptions

options = ClaudeCodeOptions(
    model="claude-sonnet-4-5"
)

# 之后
from claude_agent_sdk import query, ClaudeAgentOptions

options = ClaudeAgentOptions(
    model="claude-sonnet-4-5"
)
```

## 破坏性变更

### Python：ClaudeCodeOptions 重命名为 ClaudeAgentOptions

**变更内容：** Python SDK 类型 `ClaudeCodeOptions` 已重命名为 `ClaudeAgentOptions`。

**迁移：**

```python
# 之前 (v0.0.x)
from claude_agent_sdk import query, ClaudeCodeOptions

options = ClaudeCodeOptions(
    model="claude-sonnet-4-5",
    permission_mode="acceptEdits"
)

# 之后 (v0.1.0)
from claude_agent_sdk import query, ClaudeAgentOptions

options = ClaudeAgentOptions(
    model="claude-sonnet-4-5",
    permission_mode="acceptEdits"
)
```

### 系统提示不再是默认值

**变更内容：** SDK 不再默认使用 Claude Code 的系统提示。

**迁移：**

```typescript
// 之前 (v0.0.x) - 默认使用 Claude Code 的系统提示
const result = query({ prompt: "Hello" });

// 之后 (v0.1.0) - 默认使用空系统提示
// 要获得旧行为，请显式请求 Claude Code 的预设：
const result = query({
  prompt: "Hello",
  options: {
    systemPrompt: { type: "preset", preset: "claude_code" }
  }
});

// 或使用自定义系统提示：
const result = query({
  prompt: "Hello",
  options: {
    systemPrompt: "You are a helpful coding assistant"
  }
});
```

### 设置源不再默认加载

**变更内容：** SDK 不再默认从文件系统设置读取。

**迁移：**

```typescript
// 之前 (v0.0.x) - 自动加载所有设置
const result = query({ prompt: "Hello" });

// 之后 (v0.1.0) - 默认不加载设置
// 要获得旧行为：
const result = query({
  prompt: "Hello",
  options: {
    settingSources: ["user", "project", "local"]
  }
});

// 或仅加载特定源：
const result = query({
  prompt: "Hello",
  options: {
    settingSources: ["project"]  // 仅项目设置
  }
});
```

**为什么变更：** 确保 SDK 应用程序具有独立于本地文件系统配置的可预测行为。

## 为什么重命名？

Claude Code SDK 最初是为编码任务设计的，但它已演变成一个强大的框架，用于构建所有类型的 AI 代理。新名称"Claude Agent SDK"更好地反映了其功能：

- 构建业务代理（法律助手、财务顾问、客户支持）
- 创建专门的编码代理（SRE 机器人、安全审查员、代码审查代理）
- 为任何领域开发自定义代理，具有工具使用、MCP 集成等功能

## 后续步骤

- 探索 Agent SDK 概述 以了解可用功能
- 查看 TypeScript SDK 参考 以获取详细的 API 文档
- 查看 Python SDK 参考 以获取 Python 特定文档
- 了解 自定义工具 和 MCP 集成
