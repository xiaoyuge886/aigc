# 托管 Agent SDK

在生产环境中部署和托管 Claude Agent SDK

Claude Agent SDK 与传统的无状态 LLM API 不同，它维护对话状态并在持久环境中执行命令。

## 托管要求

### 基于容器的沙箱

SDK 应该在沙箱容器环境中运行以获得安全和隔离。

### 系统要求

每个 SDK 实例需要：

- **运行时依赖**：Python 3.10+ 或 Node.js 18+
- **资源分配**：推荐 1GiB RAM、5GiB 磁盘和 1 个 CPU
- **网络访问**：出站 HTTPS 到 `api.anthropic.com`

## 生产部署模式

### 模式 1：临时会话

为每个用户任务创建一个新容器，完成后销毁它。

**最适合**：一次性任务
- 错误调查和修复
- 发票处理
- 翻译任务
- 图像/视频处理

### 模式 2：长运行会话

为长运行任务维护持久容器实例。

**最适合**：主动代理
- 电子邮件代理
- 网站构建器
- 高频聊天机器人

### 模式 3：混合会话

临时容器，使用历史和状态进行补充。

**最适合**：与用户间歇性交互的容器
- 个人项目经理
- 深度研究
- 客户支持代理

### 模式 4：单个容器

在一个全局容器中运行多个 Claude Agent SDK 进程。

**最适合**：模拟、交互式代理游戏

## 沙箱提供商选项

| 技术 | 隔离强度 | 性能开销 | 复杂性 |
| --- | --- | --- | --- |
| 沙箱运行时 | 良好 | 非常低 | 低 |
| 容器 (Docker) | 取决于设置 | 低 | 中等 |
| gVisor | 优秀 | 中等/高 | 中等 |
| VM (Firecracker, QEMU) | 优秀 | 高 | 中等/高 |

## 常见问题

### 我如何与我的沙箱通信？

在容器中托管时，暴露端口以与您的 SDK 实例通信。

### 托管容器的成本是多少？

我们发现服务代理的主要成本是令牌，容器根据配置而异，但最低成本大约是每小时 5 美分。

### 代理会话在超时前可以运行多长时间？

代理会话不会超时，但建议设置 'maxTurns' 属性以防止无限循环。

## 后续步骤

- 安全部署 - 网络控制、凭证管理和隔离加固
- TypeScript SDK - 沙箱设置
- 会话指南 - 了解会话管理
- 权限 - 配置工具权限
- 成本跟踪 - 监控 API 使用情况
